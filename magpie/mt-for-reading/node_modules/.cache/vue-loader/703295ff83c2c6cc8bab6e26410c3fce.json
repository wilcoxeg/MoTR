{"remainingRequest":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/magpie-base/src/components/screens/EyetrackingValidationScreen.vue?vue&type=style&index=0&id=0e780588&scoped=true&lang=css&","dependencies":[{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/magpie-base/src/components/screens/EyetrackingValidationScreen.vue","mtime":1666532369711},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/css-loader/dist/cjs.js","mtime":1666532361906},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1666532366719},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/postcss-loader/src/index.js","mtime":1666532362849},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/cache-loader/dist/cjs.js","mtime":1666532360087},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/vue-loader/lib/index.js","mtime":1666532366104}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5wb2ludCB7CiAgcG9zaXRpb246IGFic29sdXRlOwp9CgoucG9pbnQuY2hlY2sgewogIHBvc2l0aW9uOiBmaXhlZDsKfQo="},{"version":3,"sources":["EyetrackingValidationScreen.vue"],"names":[],"mappings":";AAiIA;AACA;AACA;;AAEA;AACA;AACA","file":"EyetrackingValidationScreen.vue","sourceRoot":"node_modules/magpie-base/src/components/screens","sourcesContent":["<docs>\nThis screen is used to initialize and calibrate eye tracking.\nEyetracking requires that you install `webgazer`.\n\n```vue\n<Experiment wide>\n  <InstructionScreen>\n    Click the button to start full screen.\n  </InstructionScreen>\n\n  <InstructionScreen>\n    <FullScreenStart />\n    Click the button to start calibration.\n  </InstructionScreen>\n\n  <!-- We'll set debugging to true so you can see something -->\n  <EyetrackingCalibrationScreen debug />\n\n  <EyetrackingValidationScreen />\n\n  <InstructionScreen>\n    Successfully calibrated!\n  </InstructionScreen>\n\n</Experiment>\n```\n</docs>\n\n<template>\n  <Screen v-bind=\"{ ...$attrs, ...$props }\">\n    <!-- Check accuracy -->\n    <Slide>\n      <p>{{ $t('screens.EyetrackingValidationScreen.instruction') }}</p>\n      <Wait :time=\"5000\" @done=\"measureAccuracy\" />\n      <EyetrackingStart />\n      <CanvasStage\n        ref=\"checkpoint\"\n        :config=\"{ width: 26, height: 26 }\"\n        :style=\"{ top: windowHeight / 2 + 'px', left: windowWidth / 2 + 'px' }\"\n        class=\"point check\"\n      >\n        <CanvasLayer>\n          <CanvasCircle\n            :config=\"{\n              x: 13,\n              y: 13,\n              fill: 'lightblue',\n              radius: 12,\n              stroke: 'black',\n              strokeWidth: 1\n            }\"\n          ></CanvasCircle>\n        </CanvasLayer>\n      </CanvasStage>\n    </Slide>\n    <Slide>\n      <p>{{ $t('screens.EyetrackingValidationScreen.error') }}</p>\n    </Slide>\n  </Screen>\n</template>\n\n<script>\nimport Screen from '../Screen';\nimport Slide from '../Slide';\nimport EyetrackingStart from '../helpers/EyetrackingStart';\nimport Wait from '../helpers/Wait';\n\n/**\n * Inherits from LifecycleScreen\n *\n * **Global Measurements**\n *\n * |Measurement|Type|Description|\n * |--|---|---|\n * |et_accuracy|float|The measured accuracy|\n *\n */\nexport default {\n  name: 'EyetrackingValidationScreen',\n  components: { Wait, EyetrackingStart, Slide, Screen },\n  props: {\n    precision: {\n      type: Number,\n      default: 100\n    }\n  },\n  data() {\n    return {\n      x: 0,\n      y: 0,\n      calibrationSequence: []\n    };\n  },\n  computed: {\n    windowHeight() {\n      return window.innerHeight;\n    },\n    windowWidth() {\n      return window.innerWidth;\n    }\n  },\n  methods: {\n    measureAccuracy() {\n      const track = this.$magpie.eyetracking.getEyeTrack();\n      const target = { x: window.innerWidth / 2, y: window.innerHeight / 2 };\n      let accurateCount = 0,\n        dX,\n        dY,\n        distance;\n      for (let i = 0; i < track.et_x.length; i++) {\n        dX = target.x - track.et_x[i];\n        dY = target.y - track.et_y[i];\n        distance = Math.sqrt(dX ** 2 + dY ** 2);\n        if (distance < this.precision) {\n          accurateCount++;\n        }\n      }\n      const accuracy = accurateCount / track.et_x.length;\n\n      console.log('Eyetracking accuracy after calibration:', accuracy);\n\n      this.$magpie.addExpData({ et_accuracy: accuracy });\n      this.$magpie.nextScreen();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.point {\n  position: absolute;\n}\n\n.point.check {\n  position: fixed;\n}\n</style>\n"]}]}