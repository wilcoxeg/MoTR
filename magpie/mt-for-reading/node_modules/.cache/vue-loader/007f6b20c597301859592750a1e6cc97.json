{"remainingRequest":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/magpie-base/src/components/screens/EyetrackingCalibrationScreen.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/magpie-base/src/components/screens/EyetrackingCalibrationScreen.vue","mtime":1666532369682},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/cache-loader/dist/cjs.js","mtime":1666532360087},{"path":"/Users/ethan/Documents/professional/research/mt-methods/mt-for-reading/node_modules/vue-loader/lib/index.js","mtime":1666532366104}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBmbGF0dGVuIGZyb20gJ2xvZGFzaC9mbGF0dGVuJzsKaW1wb3J0IHRpbWVzIGZyb20gJ2xvZGFzaC90aW1lcyc7CmltcG9ydCBzaHVmZmxlIGZyb20gJ2xvZGFzaC9zaHVmZmxlJzsKaW1wb3J0IFNjcmVlbiBmcm9tICcuLi9TY3JlZW4nOwppbXBvcnQgU2xpZGUgZnJvbSAnLi4vU2xpZGUnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0V5ZXRyYWNraW5nQ2FsaWJyYXRpb25TY3JlZW4nLAogIGNvbXBvbmVudHM6IHsgU2xpZGUsIFNjcmVlbiB9LAogIHByb3BzOiB7CiAgICBkZWJ1ZzogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHg6IDAsCiAgICAgIHk6IDAsCiAgICAgIGNhbGlicmF0aW9uU2VxdWVuY2U6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgbmV4dFBvaW50KCkgewogICAgICBjb25zdCBuZXh0ID0gdGhpcy5jYWxpYnJhdGlvblNlcXVlbmNlLnBvcCgpOwogICAgICBpZiAobmV4dCkgewogICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgbmV4dCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWFncGllLmV5ZXRyYWNraW5nLnNldERlYWYoZmFsc2UpOwogICAgICAgIHRoaXMuJG1hZ3BpZS5uZXh0U2NyZWVuKCk7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBvblN0YXJ0KCkgewogICAgICB0aGlzLiRtYWdwaWUuZXlldHJhY2tpbmcuc2V0RGVhZih0cnVlKTsKICAgICAgdHJ5IHsKICAgICAgICAvLyBpbml0aWFsaXplIGV5ZXRyYWNraW5nCiAgICAgICAgYXdhaXQgdGhpcy4kbWFncGllLmV5ZXRyYWNraW5nLmluaXRpYWxpemUoKTsKICAgICAgICB0aGlzLiRtYWdwaWUuZXlldHJhY2tpbmcuc2V0RGVidWcodGhpcy5kZWJ1Zyk7CiAgICAgICAgdGhpcy4kbWFncGllLm5leHRTbGlkZSgpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5lcnJvcihlKTsKICAgICAgICB0aGlzLiRtYWdwaWUubmV4dFNsaWRlKDIpOwogICAgICB9CiAgICB9LAogICAgcnVuQ2FsaWJyYXRpb24oKSB7CiAgICAgIC8vIGNyZWF0ZQogICAgICBjb25zdCBleHAgPSB0aGlzLiRtYWdwaWUuZXhwZXJpbWVudC4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgIFswLCBleHAuaGVpZ2h0ICogMC4yNSwgZXhwLmhlaWdodCAvIDIsIGV4cC5oZWlnaHQgKiAwLjc1XS5mb3JFYWNoKCh5KSA9PiB7CiAgICAgICAgWwogICAgICAgICAgMCwKICAgICAgICAgIGV4cC53aWR0aCAqIDAuMjUsCiAgICAgICAgICBleHAud2lkdGggLyAyLAogICAgICAgICAgZXhwLndpZHRoICogMC43NSwKICAgICAgICAgIGV4cC53aWR0aAogICAgICAgIF0uZm9yRWFjaCgoeCkgPT4gewogICAgICAgICAgdGhpcy5jYWxpYnJhdGlvblNlcXVlbmNlLnB1c2goeyB4LCB5IH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5jYWxpYnJhdGlvblNlcXVlbmNlID0gZmxhdHRlbigKICAgICAgICB0aW1lcygyLCAoKSA9PiBzaHVmZmxlKHRoaXMuY2FsaWJyYXRpb25TZXF1ZW5jZSkpCiAgICAgICk7CiAgICAgIHRoaXMubmV4dFBvaW50KCk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["EyetrackingCalibrationScreen.vue"],"names":[],"mappings":";AA8DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EyetrackingCalibrationScreen.vue","sourceRoot":"node_modules/magpie-base/src/components/screens","sourcesContent":["<docs>\nThis screen is used to initialize and calibrate eye tracking.\nEyetracking requires that you install `webgazer`.\n\n```vue\n<Experiment wide>\n  <InstructionScreen>\n    Click the button to start full screen.\n  </InstructionScreen>\n\n  <InstructionScreen>\n    <FullScreenStart />\n    Click the button to start calibration.\n  </InstructionScreen>\n\n  <!-- We'll set debugging to true so you can see something -->\n  <EyetrackingCalibrationScreen debug />\n\n  <InstructionScreen>\n    Successfully calibrated!\n  </InstructionScreen>\n\n</Experiment>\n```\n</docs>\n\n<template>\n  <Screen v-bind=\"{ ...$attrs, ...$props }\">\n    <Slide>\n      <Wait key=\"start\" :time=\"0\" @done=\"onStart\" />\n      <p>{{ $t('screens.EyetrackingCalibrationScreen.start') }}</p>\n    </Slide>\n    <Slide>\n      <Wait key=\"calibration\" :time=\"0\" @done=\"runCalibration\" />\n      <p>{{ $t('screens.EyetrackingCalibrationScreen.instruction') }}</p>\n      <CanvasStage\n        :config=\"{ width: 26, height: 26 }\"\n        :style=\"{ left: x + 'px', top: y + 'px' }\"\n        class=\"point\"\n        @click=\"nextPoint\"\n      >\n        <CanvasLayer>\n          <CanvasCircle\n            :config=\"{\n              x: 13,\n              y: 13,\n              fill: 'red',\n              radius: 12,\n              stroke: 'black',\n              strokeWidth: 1\n            }\"\n          ></CanvasCircle>\n        </CanvasLayer>\n      </CanvasStage>\n    </Slide>\n    <Slide>\n      <p>{{ $t('screens.EyetrackingCalibrationScreen.error') }}</p>\n    </Slide>\n  </Screen>\n</template>\n\n<script>\nimport flatten from 'lodash/flatten';\nimport times from 'lodash/times';\nimport shuffle from 'lodash/shuffle';\nimport Screen from '../Screen';\nimport Slide from '../Slide';\nexport default {\n  name: 'EyetrackingCalibrationScreen',\n  components: { Slide, Screen },\n  props: {\n    debug: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      x: 0,\n      y: 0,\n      calibrationSequence: []\n    };\n  },\n  methods: {\n    nextPoint() {\n      const next = this.calibrationSequence.pop();\n      if (next) {\n        Object.assign(this, next);\n      } else {\n        this.$magpie.eyetracking.setDeaf(false);\n        this.$magpie.nextScreen();\n      }\n    },\n    async onStart() {\n      this.$magpie.eyetracking.setDeaf(true);\n      try {\n        // initialize eyetracking\n        await this.$magpie.eyetracking.initialize();\n        this.$magpie.eyetracking.setDebug(this.debug);\n        this.$magpie.nextSlide();\n      } catch (e) {\n        console.error(e);\n        this.$magpie.nextSlide(2);\n      }\n    },\n    runCalibration() {\n      // create\n      const exp = this.$magpie.experiment.$el.getBoundingClientRect();\n      [0, exp.height * 0.25, exp.height / 2, exp.height * 0.75].forEach((y) => {\n        [\n          0,\n          exp.width * 0.25,\n          exp.width / 2,\n          exp.width * 0.75,\n          exp.width\n        ].forEach((x) => {\n          this.calibrationSequence.push({ x, y });\n        });\n      });\n      this.calibrationSequence = flatten(\n        times(2, () => shuffle(this.calibrationSequence))\n      );\n      this.nextPoint();\n    }\n  }\n};\n</script>\n\n<style scoped>\n.point {\n  position: absolute;\n}\n\n.point.check {\n  position: fixed;\n  left: 50vw;\n  top: 40vh;\n}\n</style>\n"]}]}